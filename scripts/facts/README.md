# Facts Pipeline Notes

This folder contains scripts to build a large `Fact or Fake` dataset with separate pools:

- `realFacts[]`
- `fakeFacts[]`

Each fact has this shape:

- `id`
- `category.en` / `category.ru`
- `text.en` / `text.ru`

## 1) Extract candidate lines from EPUB

```bash
npm run facts:extract:epub -- "/Users/kmarkosyan/Downloads/The_Book_of_General_Ignorance.epub" data/facts/book-candidates.json
```

## 2) Build large dataset from EPUB candidates

```bash
npm run facts:build:epub -- data/facts/book-candidates.json data/facts/fact-or-fake.generated.json
```

Default targets:

- `REAL_TARGET=6000`
- `FAKE_TARGET=2400`

You can override:

```bash
REAL_TARGET=8000 FAKE_TARGET=3200 npm run facts:build:epub -- data/facts/book-candidates.json data/facts/fact-or-fake.generated.json
```

## 3) Fetch bilingual facts from Wikidata (SPARQL)

```bash
npm run facts:fetch:wikidata -- data/facts/fact-or-fake.generated.json
```

This appends bilingual (`EN` + `RU`) facts and fakes generated by safe value-swapping inside the same template/category.

Optional environment variables:

- `WIKIDATA_LIMIT` (default `700` per template)
- `WIKIDATA_FAKE_TARGET` (default `2600`)

## 4) Runtime source

Generated facts are loaded at runtime from:

- `data/facts/fact-or-fake.generated.json`

Curated seed facts remain in:

- `lib/games/fact-or-fake/facts.ts`
